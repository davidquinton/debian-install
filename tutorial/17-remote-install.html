---
layout: default
description: Installing Debian with custom software and user config in places without the internet, using Simple-CDD and Live-Helper - by D Quinton
title: Remote install
id: tutor
---

<div class="onpage">
  <ul>
    <li>
        On this page          <a href="#">TOP</a>
             <ul>
                <li><a href="#1">Cloning the apt-cache!</a></li>
                <li><a href="#1a">Keryx </a></li>
                <li><a href="#2">Simple-CDD  </a></li>
                <li><a href="#3">Live-Helper </a></li>
             </ul>
    </li>
  </ul>
</div>

<div class="pagemenu">
<table cellpadding="5"><tr><td>
   <a href="#1">Cloning the apt-cache!</a><br>
   <a href="#1a">Keryx  </a><br>
   <a href="#2">Simple-CDD  </a><br>
   <a href="#3">Live-Helper </a><br>
</td></tr></table>
</div>
<div class="parent"><a href="../tutorials.html">Tutorials</a> ></div>

<div class="cont">


<br>

Back in 2012, I was trying everything I could do to get a customised Live CD put together so that I could start installing Debian on other PC's.  I spent a long time learning how to use Live Helper, and tweaked it so that I could get a Live CD to install with about 95% of the apps and config I wanted.  But then how about updating the Live CD?  Another build process over the internet that can take hours.  
<br><br>

More recently I've had success with refractasnapshot (system backup page), which makes a Live CD from an installed system.  So from the system installed with my Live Helper-made Live CD, which I upgraded and dist-upgraded, and tweaked with all the config I wanted, I made a snapshot of it and now I have a grand "2nd generation" Live CD.
<br><br>

So, if you were to use Live Helper, you probably shouldn't spend so much time getting the config files into it, and hefty-sized deb archives, but try to build just a <i>basic</i> Live Debian to install on a test-bed partition.  Then boot into that and make all the fine tuning you need.  Finally build your 2nd and better Live CD with refractasnapshot, or even partclone (see my <a href="16-system-backup.html">system backup</a> page for those two).
<br><br>

<br>


<h2 id="1" class="tag">Cloning the apt-cache!</h2>

I've been pondering on the task of installing Linux (Debian wheezy LXDE) to remote laptops (zero internet connectivity), but having a connected laptop at base.

<br>
Obviously, a customised Live CD would be the ideal option of installing the system with all the app's needed.
<br>
Otherwise, I could "clone" my install on the connected laptop by using the same Live CD on the remote PC's and copying the apt index and apt cache onto them.  But would it work?
<br><br>
On connected laptop (a):


<div class="numb">
<ol><li>Install Live CD X (preferred Debian)</span></li>
<li>Remove/install apps and make apt-get remove line Y, install line Z</li>
<li>Copy <span style="color: #3d85c6" >/var/lib/apt/lists/</span> (Apt-L), <span style="color: #3d85c6" >/var/cache/apt/ </span> (Apt-C), plus config files (CF), /etc/apt/sources.list (SL), libflashplayer.so from /usr/lib/chromium/plugins to a USB stick</li>
</ol></div >
<br>

on remote laptop (b)</span>
<div class="numb">
<ol><li>Install X  </span></li>
<li>Fine details: add user to sudoer, "no recommends" file, edit fstab</span></li>
<li>copy over Apt-</span>L and Apt-</span>C</span></li>
<li>Execute apt-get lines Y and Z</span></li>
<li>Copy over config files and CTRL-ALT F2, reboot</span></li>
<li>Install other apps from deb's</span></li>
<li>Copy over SL to (b) (in case of internet connectivity later) and attempt wireless driver install on (b) to make internet-ready</span></li>
<li>Copy over libflashplayer.so </span></li>
</ol>
</div >
<br><br>

Future update of laptop (b) should be possible too.
<div class="numb">
<ol><li>on (a) apt-get clean &amp; apt-get update &amp; apt-get upgrade</span></li>
<li>copy Apt-L</span> and Apt-C </span>from (a)</span></li>
<li>delete and replace Apt-</span>L and Apt-</span>C on (b) with those new from (a)</span></li>
<li>on (b) run apt-get upgrade</span></li>
</ol></div >

<br>

This page here <a href="http://gnuser.wordpress.com/2007/11/20/installing-packages-on-debian-computers-without-internet-connection/">http://gnuser.wordpress.com...</a> is very helpful method for installing packages on a PC with no internet connection.  If it is an unknown Debian install, or it's out of date, or out of sync with the connected machine (a), then it would be necessary to find out which packages are needed as there may well be many more needed than the base PC (a) would need during an update.</span>
<br><br>
<br>

<h2 id="1a" class="tag">The right tool</h2>

Well, now I found there's a tool that's just right for this... <b>Keryx</b>.  It makes a database for a target box, ie with what packages it has, and what versions, and then uses an online box to retrieve what it needs to update or install new on the target - all via a USB stick.  
<br><br>
<a href="http://opensourceforu.efytimes.com/2010/09/offline-package-install-linux-made-easy-keryx/">see about...</a>  Get it here <a href="https://launchpad.net/keryx">https://launchpad.net/keryx</a>


<br><br><br><br>


<h2 id="2" class="tag">Simple-CDD</h2>
<a href="http://wiki.debian.org/Simple-CDD/Howto">http://wiki.debian.org/...</a>
<br>

<form><textarea name="T" id="install" rows="1" cols="50">
sudo apt-get install simple-cdd approx</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

Firstly, make a working directory where you've got some space
<form><textarea name="T" id="cmd" rows="2" cols="30">
mkdir my-simple-cdd
cd /my-simple-cdd </textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br>
this is the basic build command, which may be out-dated by now:

<form><textarea name="T" id="install" rows="1" cols="100">
build-simple-cdd --dist wheezy --debian-mirror http://cdn.debian.net/debian --profiles NAME </textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


fill in your own preferred mirror!
<br><br>

to make the profiles file (with package names), in my-simple-cdd dir:

<form><textarea name="T" id="cmd" rows="2" cols="80">
mkdir profiles
for p in <packages to include> ; do echo $p >> profiles/NAME.packages ; done</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br><br>


simple-cdd defaults to just using main, so to also use contrib and non-free, put this in profiles/default.conf:

<form><textarea name="T" id="file" rows="1" cols="50">
mirror_components="main contrib non-free"</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>
<br>

set up <b>approx</b> to cache packages <br>
<a href="http://www.debianadmin.com/upgrade-multiple-debian-systems-with-approx.html">http://www.debianadmin.com/...</a> <br>
I still can't get this to work.
<br> <br>

set the mirror and un-comment some lines in the file

<form><textarea name="T" id="cmd" rows="1" cols="50">
sudo nano /etc/approx/approx.conf</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br>
e.g.
<form><textarea name="T" id="file" rows="3" cols="50">
debian          http://cdn.debian.net/debian
security        http://security.debian.org
deb-multimedia  http://www.deb-multimedia.org</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br>


<br>
import the apt cache into approx cache (only if deb files are recent)


<form><textarea name="T" id="cmd" rows="3" cols="50">
sudo approx-import /var/cache/apt/archives/*.deb
sudo service networking restart
sudo service openbsd-inetd restart </textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


<br>

lastly, invoke simple-cdd to pull from approx cache

<form><textarea name="T" id="cmd" rows="1" cols="100">
build-simple-cdd --dist wheezy --debian-mirror http://localhost:9999/debian --profiles NAME </textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


<br><br><br>


<h2 id="3" class="tag">Live-helper</h2>

<a href="http://live-systems.org/manual/current/html/live-manual/toc.en.html">http://live-systems.org/manual/current/html/live-manual/toc.en.html</a>
<br>

useful read:
<a href="http://live-systems.org/manual/current/html/live-manual/customization-overview.en.html#334">live-manual/customization-overview....</a>
<br><br>


<hr>

<h3>1. install</h3>
add sid snapshots to sources list (not sure if this is still required?)

<form><textarea name="T" id="cmd" rows="6" cols="100">
su
sh -c 'echo "deb http://live.debian.net/debian/ sid-snapshots main contrib non-free" &gt;&gt; /etc/apt/sources.list'
wget http://live.debian.net/debian/project/keys/archive-key.asc -O - | apt-key add -
apt-get update
apt-get install live-helper</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>
now find some space on a partition where all the live-build work will take place 


<form><textarea name="T" id="cmd" rows="3" cols="30">
mk dir my-livecd
cd my-livecd
lh config</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

(that will build the basic config tree)
<br><br><br>


<hr>

<h3>2. Congfiguring how the live cd will be built</h3>
The command is run with options to build what you want:
<br><br>
example 1.

<form><textarea name="T" id="cmd" rows="2" cols="100">
lh config --architecture i386 -d wheezy -p lxde --archive-areas "main contrib non-free" --debian-installer live</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>
example 2.<br>

<form><textarea name="T" id="cmd" rows="2" cols="100">
lh config -d squeeze -p xfce --archive-areas "main contrib non-free" --debian-installer live --linux-flavours 686</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br>

example 3.
<form><textarea name="T" id="cmd" rows="4" cols="100">
lh config --mirror-bootstrap "http://cdn.debian.net/debian/" --mirror-chroot "http://cdn.debian.net/debian/" --mirror-chroot-security "http://security.debian.org/debian/" --apt-recommends disabled --architecture i386 --linux-flavours 486 --archive-areas "main contrib non-free" -d wheezy --debian-installer live --apt aptitude</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

You can keep using "lh config" with different parameters to set up the configuration before building -but note that you can't override one that's been set unless you do a "lh clean" -it is better to use an auto script (see below).  The "chroot" mirror is where packages will come from and the "binary" is what the Live CD will be set to (chroot mirror should default to --mirror-bootstrap).  
See <a href="http://manpages.ubuntu.com/manpages/oneiric/lb_config.1..html">http://manpages.ubuntu.com/</a>
<br><br>
The 486 flavour with i386 architecture, or 686 with amd64, is essential for the live installer to work, or else you will just have a Live CD, so the man page says.
<br><br>

<b>Or use an auto script</b><br>
All config options can be put into an auto script so that one only needs to run "lh config" and the options are set from the script.
<br>
<a href="http://live-systems.org/manual/current/html/live-manual/managing-a-configuration.en.html#309">http://live-systems.org/manual/...</a>
<br><br>

<form><textarea name="T" id="cmd" rows="1" cols="80">
cp /usr/share/doc/live-build/examples/auto/* auto/</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

edit auto/config to look something like this -adapt to your preference, with amd64/686 or whatever.  Here's how it looks with my example 3,
<span style="color: #0F4F0B" size="3">#!/bin/sh<br>
lb config noauto \<br>
     --architectures <span style="background-color:rgb(249,203,156)">i386</span> \<br>
     --linux-flavours <span style="background-color:rgb(249,203,156)">486</span> \<br>
     --mirror-bootstrap http://<span style="background-color:rgb(249,203,156)">ftp.uk.debian.org</span>/debian/ \<br>
<span style="color: #0F4F0B" size="3">    --mirror-chroot http://<span style="color:rgb(56,118,29);background-color:rgb(249,203,156)">ftp.uk.debian.org</span>/debian/ \<br>
     --mirror-binary http://<span style="color:rgb(56,118,29);background-color:rgb(249,203,156)">ftp.uk.debian.org</span>/debian/ \<br>
     --mirror-chroot-security http://security.debian.org/ \<br>
     --archive-areas "main contrib non-free" \<br>
--apt-recommends disabled \<br>
</span>
    --apt aptitude \<br>
         -d <span style="background-color:rgb(249,203,156)">wheezy</span> \<br>
         --debian-installer live \<br>
     "${@}"
<br>
</span>

<br><br>
The script is read when lh build is run.
<br><br>

Note: in the file <span style="color: #0b5394">config/bootstrap</span> there is also  LB_PARENT_MIRROR_BOOTSTRAP...   and LB_PARENT_MIRROR_CHROOT...  which seem to override the  <span style="color:rgb(56,118,29)">--mirror-bootstrap </span>and <span style="color:rgb(56,118,29)"> --mirror-chroot </span>parameters so that during the build packages are retrieved from ftp.debian.org, not from your prefered mirror.
<br>

<br>
<hr>

<h3>3. Add package lists before the build</h3>
<br>
updated Oct 2017
<br><br>
su to root and run these in the build directory, to create lists which will be used to install whatever you need to the build:

<br><br>
First of all, those needed for successful build as they are possibly excluded by the "no-recommends" option.
<br>
<textarea name="T" id="cmd" rows="3" cols="100">
for p in eject file live-boot-doc rsync uuid-runtime live-config-doc live-tools sudo user-setup grub2 consolekit aptitude laptop-mode-tools network-config iw ;do echo $p &gt;&gt; config/package-lists/needed.list.chroot ;done</textarea>
 <input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br><br>
then do either

<br>
<b>1. minimal LXDE install</b>
<br>
<textarea name="T" id="cmd" rows="5" cols="100">
for p in xorg lxde lightdm lxtask pm-utils hdparm cpufrequtils alsa-utils wicd tango-icon-theme dmz-cursor-theme moblin-cursor-theme obconf obmenu lxappearance-obconf leafpad xfce4-power-manager rxvt-unicode htop elinks gparted aptitude bash-completion command-not-found ntp debian-installer-launcher ;do echo $p &gt;&gt; config/package-lists/base.list.chroot ;done</textarea>
 <input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


<br>
or <br>
<b>2. plain openbox install</b>
<br>
<textarea name="T" id="cmd" rows="5" cols="100">
for p in aptitude xorg lxtask pm-utils hdparm cpufrequtils alsa-utils openbox lxpolkit lxpanel lxtask wicd tango-icon-theme obconf obmenu lxappearance-obconf moblin-cursor-theme rxvt-unicode leafpad xfce4-power-manager htop elinks gparted aptitude bash-completion command-not-found udiskie gvfs ntp debian-installer-launcher ;do echo $p &gt;&gt; config/package-lists/base.list.chroot ;done</textarea>
 <input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br><br>

<b>For Thunar</b>
<br>
<textarea name="T" id="cmd" rows="4" cols="100">
for p in thunar thunar-volman thunar-archive-plugin thunar-media-tags-plugin tumbler tumbler-plugins-extra bluetooth blueman ntfs-3g blktool dosfstools mtools testdisk gvfs-backends zip unzip bzip2 p7zip-full openjdk-8-jre icedtea-8-plugin git cups gpa ntp rpl ;do echo $p config/package-lists/thunar.list.chroot ;done</textarea>
 <input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br><br>

<b>All other apps</b>
<br>
<textarea name="T" id="cmd" rows="7" cols="100">
for p in mpv vlc handbrake audacious gnome-sound-recorder lame gimp darktable inkscape abcde eyed3 bashburn gnome-color-chooser xpdf x11-apps feh imagemagick xsel xvkbd w3m w3m-img atool mediainfo jhead ffmpegthumbnailer gpsbabel clipit uget clamtk gdmap bleachbit transmission ksnapshot kcharselect luckybackup meld regexxer xiphos fonts-sil-ezra rkhunter chkrootkit goldendict xfce4-notes-plugin hasciicam bluefish filezilla yelp easytag catfish pyrenamer xfburn xpad gtk2-engines gtk2-engines-xfce gtk3-engines-xfce ;do echo $p config/package-lists/apps.list.chroot ;done</textarea>
 <input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>



<br><br>

<b>For build dependencies</b>
<br>
<textarea name="T" id="cmd" rows="4" cols="100">
for p in build-essential intltool pkg-config libalglib-dev libglib2.0-dev libdbus-1-dev libdbus-glib-1-dev libx11-dev libgtk2.0-dev libwnck-dev x11-xserver-utils libgudev-1.0-dev libgtkmm-2.4-dev libssl-dev libnotify-dev gcc make cmake checkinstall ;do echo $p config/package-lists/build.list.chroot ;done</textarea>
 <input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br><br>
<a href="http://live-systems.org/manual/current/html/live-manual/customizing-package-installation.en.html#373">http://live-systems.org/manual/...</a>
<br>
<br><br>


<hr>


<h3>4. Add other/customised packages</h3> 
Put their .deb archives in config/packages.chroot -for example, most recent XnviewMP, refractasnapshot etc. 
<br><br>
! Check the packages names with running <span style="color: #6A3200" >dpkg-name *.deb</span> in the dir as they must comply to be included.<br>
<a href="http://live-systems.org/manual/current/html/live-manual/customizing-package-installation.en.html">http://live-systems.org/manual/...</a>

<br><br>


Note with thunar: the latest is found in <a href="http://packages.debian.org/experimental/thunar">experimental</a>, but it has so many dependencies it failed to install for me using packages.
<br><br>
Therefore it is wiser to pin it to the experimental repository, with all other packages defaulting to the config repository, like this


<form><textarea name="T" id="cmd" rows="2" cols="80">
echo "deb http://ftp.uk.debian.org/debian/ experimental main" > config/archives/experimental.list.chroot</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>
<form><textarea name="T" id="cmd" rows="1" cols="80">
sudo leafpad config/archives/experimental.pref.chroot</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


<br>

add this content


<form><textarea name="T" id="file" rows="8" cols="80">
Package: thunar libexo-1-0 libxfce4ui-1-0 libxfce4util6 thunar-data libxfce4ui-1-dev libthunarx-2-0 exo-utils libxfce4util-dev libxfconf-0-dev libxfconf-0-2
Pin: release n=experimental
Pin-Priority: 600

Package: *
Pin: release n=experimental
Pin-Priority: 1</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>



<b>Omit a package from the build </b>
-say, if it is a recommended package or installed by a metapackage, you give it a negative Pin-Priority in config/apt/preferences,

<form><textarea name="T" id="cmd" rows="1" cols="50">
sudo leafpad config/apt/preferences</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<form><textarea name="T" id="file" rows="3" cols="30">
Package: iceweasel
Pin: version *
Pin-Priority: -1</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


<br>

see: <a href="http://live-systems.org/manual/current/html/live-manual/customizing-package-installation.en.html#466">.../customizing-package-installation.en.html#466</a>
<br>
<br><br>

<hr>

<h3>5. add the multimedia repo</h3>
add the multimedia repository (or any repo you like, same method), in my-livecd dir:

<form><textarea name="T" id="cmd" rows="2" cols="100">
echo "deb http://www.deb-multimedia.org testing main non-free" > config/archives/deb-multimedia.list.chroot </textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

copy deb-multimedia-keyring.gpg 
<form><textarea name="T" id="cmd" rows="1" cols="100">
cp /usr/share/keyrings/deb-multimedia-keyring.gpg config/archives/deb-multimedia.key.chroot</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br><br><br>

<hr>

<h3>6. live-initramfs </h3>
(this is not in the recent debian live manual -try without first)
<br>
Enable live-helper to use the latest snapshot of live-initramfs with a sources list entry (run in my-livecd dir)

<form><textarea name="T" id="cmd" rows="3" cols="80">
mkdir config/chroot_sources
sh -c 'echo "deb http://live.debian.net/ sid-snapshots main contrib non-free" &gt; config/chroot_sources/debian-live_sid-snapshots.chroot'</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>
and at binary stage with
<form><textarea name="T" id="cmd" rows="2" cols="80">
cp config/chroot_sources/debian-live_sid-snapshots.chroot config/chroot_sources/debian-live_sid-snapshots.binary<br></textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>


get the gpg key:

<form><textarea name="T" id="cmd" rows="2" cols="80">
wget http://live.debian.net/debian/project/keys/archive-key.asc -O config/chroot_sources/debian-live_sid-snapshots.chroot.gpg</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>
copy it to the binary

<form><textarea name="T" id="cmd" rows="2" cols="80">
cp config/chroot_sources/debian-live_sid-snapshots.chroot.gpg config/chroot_sources/debian-live_sid-snapshots.binary.gpg</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br>
<a href="http://live.debian.net/manual/1.x/html/ch02s02.html">http://live.debian.net/manual/1.x/html/ch02s02.html</a><br>
<a href="http://live.debian.net/debian/project/keys/">http://live.debian.net/debian/project/keys/</a>
<br>
<br>

or get the <a href="http://packages.debian.org/wheezy/live-boot-initramfs-tools">live-boot-initramfs-tools</a> deb file and put it in config/packages.chroot <br>

<br><br><br>

<hr>

<h3>7. Add files to be included in the Live cd</h3>

If you'd like to customize the Live cd environment, with autostart, no recommends files etc, you simply add the files to <span style="color: #0b5394">config/includes.chroot </span>directory with the same dir tree as they need in a real file system.
<br>
<ul><li>put the LXDE autostart file in <span style="background-color:rgb(208,224,227)">config/includes.chroot/etc/xdg/lxsession/LXDE/</span></li></ul>


Add config files to <span style="background-color:rgb(208,224,227)">config/includes.chroot/etc/skel/</span> so that they will be used to create the live user's home directory... and the installed user's?
<br><br>
<a href="http://live-systems.org/manual/current/html/live-manual/customizing-contents.en.html#479" >http://live-systems.org/manual/...</a>
<br>

<br><br>


<b>Set groups for the Live user</b>
<br>
make a file

<form><textarea name="T" id="cmd" rows="1" cols="80">
leafpad config/includes.chroot/etc/live/config/user-setup.conf</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


and fill with [include whatever groups you require]

<form><textarea name="T" id="file" rows="1" cols="80">
LIVE_USER_DEFAULT_GROUPS="plugdev netdev powerdev dialout lpadmin admin clamav"</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

<br><br>

<hr>


<h3>8. Building the live cd</h3>

to run live build, cd to my-livecd and enter (sudo or as root)

<form><textarea name="T" id="cmd" rows="1" cols="30">
lh build</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>
<br>
debian live manual now uses lb build (same thing?)
<br><br>

to cleanup the working directory to build again 

<form><textarea name="T" id="cmd" rows="1" cols="30">
lh clean --binary</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

to build again with changes to config (this cleans chroot so all the packages will need unpacking again with the next build)<br>


<form><textarea name="T" id="cmd" rows="2" cols="30">
lh clean
lh build</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

to build with interactive options

<form><textarea name="T" id="cmd" rows="3" cols="50">
lh clean
lh config --interactive shell
lh build</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

The iso file will be created (if successful) in the "my-livecd" directory, which just needs (renaming and) burning to disk or sending to a usb stick.
<br><br>

You can make a live build from your installed system with (haven't tested it myself)

<form><textarea name="T" id="cmd" rows="2" cols="50">
lh config --bootstrap copy --debian installer live
lh build</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br><br><br>


<hr>

<h3>Notes</h3>

<div class="bullet">
<ul><li>if a build has been interrupted, lh build might fail, if so do</li>
<form><textarea name="T" id="cmd" rows="2" cols="30">
lh clean --purge 
lh build</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


but it <i>will </i>clean out the cache!  
<br><br>

   Example, the build fails with an error:<br>

<span style="color: #134f5c;background-color:rgb(217,210,233)">P: Configuring file /etc/debian_chroot
    /usr/share/live/build/scripts/build/lb_chroot_debianchroot: 50: /usr/share/live/build/scripts/build/lb_chroot_debianchroot: cannot create       chroot/etc/debian_chroot: Directory nonexistent<br>
    P: Begin unmounting filesystems...<br>
    P: Saving caches...<br>
    chroot: failed to run command `/usr/bin/env': No such file or directory</span>

<br><br>

Another one would be:<br>
     <span style="color: #134f5c;background-color:rgb(217,210,233)"> P: Begin install linux-image... cp: cannot stat `chroot/boot/vmlinuz-*': No such file or directory <br>
P: Begin unmounting filesystems</span> 
<br>

And this error would require unmounting the file system where the build was in process in order to build successfully. See here <a href="http://www.mail-archive.com/debian-live-devel@lists.alioth.debian.org/msg03522.html">mail-archive...</a>
<br><br>

 Another error I had was aptitude failing to download packages and reporting:<br><br>

 <span style="color: #134f5c;background-color:rgb(217,210,233)">E: Cannot get debconf version. Is debconf installed?</span>
        
<br><br>
try fixing this with

<form><textarea name="T" id="cmd" rows="2" cols="100">
cd chroot/var/lib/dpkg/
cp available-old available && cp diversions-old diversions && cp status-old status</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>

<br>

<li>I also found out that build will terminate prematurely if the filesystem is mounted with "noexec" or "nodev" (which are set by "user" or "users" in fstab!) So what I did was edit /etc/fstab for the partition I'm using for backups and live-helper, remove "users" from the line, then do `sudo mount -a` (remounted drives as per fstab) 
<br>
because of this running live build on a separate partition to any system/data partition is probably essential.
<br>
Then use sudo chown -R on the 'my-livecd' dir, to allow write access to the live build directory, which is more useful.</li>

<li>the build may also terminate if APT is specified and there is a package not found. You can switch to Aptitude so that the build won't terminate on these, with: <span style="color:#6A3200">lh config --apt aptitude</span></li>


<li>there's a catch to turning off package recommends as there are some needed recommends (to make the live cd work) and these will need to be added to the package lists (list made above), see <a href="http://live-systems.org/manual/current/html/live-manual/customizing-package-installation.en.html">customizing-package-installation</a></li>

<li>recommends for <a href="http://packages.debian.org/wheezy/live-boot">live-boot</a> and <a href="http://packages.debian.org/wheezy/live-config">live-config</a> include: <span style="color: #7C2020">eject file live-boot-doc rsync uuid-runtime live-config-doc live-tools sudo user-setup</span></li>



<li>my build couldn't find "linux-firmware" even with "contrib non-free" set in the config so I got the deb files and put them config/packages.chroot, which were:<span style="color: #0b5394"> firmware-linux firmware-linux-free firmware-linux-nonfree  </span>from<a href="http://packages.debian.org/wheezy/firmware-linux">http://packages.debian.org</a></li>

<li>I also downloaded and put <span style="color: #0b5394">debian-installer-launcher </span>in config/packages.chroot to make sure it was added.</li>

<li>the first time I got stuck with multiarch-support libgcc1 libc6 pre-depends circle!  But that may have been fixed now as a bug.</li>

<li>Second time the Live CD built successfully! But I had no live-installer because my lh config flag was --debian-installer=true (incorrect) and not --debian-installer live</li>

<li>Third time and "LiveInstaller" was found in the Other sub-menu (it is also found in System &gt;Install Debian Sid).  It complained about the kernel version that I needed to boot the 486 kernel, but I just continued and it allowed me to install. </li>
<li>Xfce4-power-manager and catfish were the only two app's that couldn't run on the new install.  Running apt-get build-dep I found quite a lot of dependencies were missing.  I guess these could be added to a package list to get them added to the build.  Run these commands in the build directory:</li></ul>
<br>
<b>catfish</b>

<div style="overflow:auto;width:750px;height:60px;background-color:#ffccff">
 for p in binutils build-essential debhelper dpatch dpkg-dev g++ g++-4.7 gcc gcc-4.7
  gettext gettext-base html2text intltool-debian libasprintf0c2 libc-dev-bin
  libc6-dev libdpkg-perl libgettextpo0 libitm1 libstdc++6-4.7-dev
  linux-libc-dev make patch po-debconf ;do echo $p &gt;&gt; config/package-lists/catfishdep.list.chroot ;done
</div>
<br>

<b>xfce4-power-manager</b>
<div style="overflow:auto;width:750px;height:60px;background-color:#ffccff">
 for p inautoconf automake autotools-dev binutils build-essential debhelper dpkg-dev
  g++ g++-4.7 gcc gcc-4.7 gettext gettext-base gir1.2-notify-0.7
  gir1.2-polkit-1.0 html2text intltool intltool-debian libasprintf0c2
  libatk1.0-dev libc-dev-bin libc6-dev libcairo-script-interpreter2
  libcairo2-dev libdbus-1-dev libdbus-glib-1-dev libdpkg-perl libexpat1-dev
  libfontconfig1-dev libfreetype6-dev libgdk-pixbuf2.0-dev libgettextpo0
  libglib2.0-bin libglib2.0-dev libgtk2.0-dev libice-dev libitm1 libnotify-dev
  libpango1.0-dev libpcre3-dev libpixman-1-dev libpng12-dev
  libpolkit-gobject-1-dev libpthread-stubs0 libpthread-stubs0-dev libsm-dev
  libstdc++6-4.7-dev libx11-dev libxau-dev libxcb-render0-dev libxcb-shm0-dev
  libxcb1-dev libxcomposite-dev libxcursor-dev libxdamage-dev libxdmcp-dev
  libxext-dev libxfce4ui-1-dev libxfce4util-dev libxfconf-0-dev libxfixes-dev
  libxft-dev libxi-dev libxinerama-dev libxrandr-dev libxrender-dev
  linux-libc-dev m4 make patch pkg-config po-debconf x11proto-composite-dev
  x11proto-core-dev x11proto-damage-dev x11proto-fixes-dev x11proto-input-dev
  x11proto-kb-dev x11proto-randr-dev x11proto-render-dev x11proto-xext-dev
  x11proto-xinerama-dev xfce4-panel-dev xorg-sgml-doctools xtrans-dev
  zlib1g-dev ;do echo $p &gt;&gt; config/package-lists/xfce4-pman-dep.list.chroot ;done

</div>




<br>

<br>
<b>Install problems</b>

<ul><li>No ext3 or ext4 partitioning option!  So I had to select "Use free space automatically".  this made ext4 partitions for / and /home and a swap of 4Gb.  Later, with Gparted, I removed the /home and swap partitons and made new ones (smaller).  After booting the system, and logging in as root, /etc/fstab needed making and /dev/sda? mounting to /home.  Then I could log in as my user.</li>
<li>with one install I still couldn't log-in the user, so logged in as root, deleted that user with <span style="color: #6A3200">deluser bob </span>and then added it again with <span style="color: #6A3200">adduser bob</span>, and bob was then added to /home and I could log-in</li>
<li>GRUB did not install and, as I was installing to a Win7 machine and needed it to dual-boot, I used Super Grub (Rescatux) to boot the new OS, then I ran</li></ul>

<form><textarea name="T" id="cmd" rows="2" cols="50">
sudo apt-get install grub
sudo grub-install /dev/sda</textarea>
&nbsp;<input type="button" class="submitLink" value="Select all" onClick="javascript:this.form.T.focus();this.form.T.select();">
</form>


<ul><li>Grub Recover CD does a good job too, automatically searches for OS and installs GRUB with options -see my <a href="../helps/02-grub.html">GRUB page</a></li>
<li>In fact, if I attempted GRUB install the installer terminated early without finishing (set up users and passwords etc) so I found I had to use the "Go back" button at Configure Mirrors stage in order to select "Continue without installing GRUB".</li></ul>
<br><br><br><br><br>
</div>
</div>
